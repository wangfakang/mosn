{
  "servers":[
     {
       "default_log_path":"stdout",
       "default_log_level":"INFO",
       "listeners":[
          {
            "name":"serverListener",
            "address": "0.0.0.0:2046",
            "bind_port": true,
            "use_original_dst": false,
            "log_path": "stdout",
            "filter_chains": [{
               "tls_context":{
                       "status": false,
                       "ca_cert":"./examples/codes/certs/ca.pem",
                       "cert_chain":"./examples/codes/certs/cert.pem",
                       "private_key":"./examples/codes/certs/key.pem",
                       "verify_client": false,
                       "require_client_cert": false
               },
               "filters": [
                         {
                   "type": "proxy",
                   "config": {
                      "downstream_protocol": "Auto",
                      "upstream_protocol": "Http1",
                         "router_config_name":"server_router"

                   }
                         },
                         {
                         "type":"connection_manager",
                         "config":{
                           "router_config_name":"server_router",
                           "virtual_hosts":[{
                                 "name":"serverHost",
                                 "domains": ["*"],
                                 "routers": [
                                   {
                                         "match":{"prefix":"/"},
                                         "route":{"cluster_name":"serverCluster"}
                                   }
                                 ]
                           }]
                          
                         }
                         }]
            }],
            "listener_filters": [
           ],
 "stream_filters": [
            {
              "type": "dsl",
              "config": {
                  "log_filter_by_dsl":"ctx.rewrite_request_url(\"xxx\")"
              }
            }
          ]
          },
          {
            "name":"clientListener",
            "address": "127.0.0.1:8899",
            "bind_port": true,
            "log_path": "stdout",
            "filter_chains": [{
               "tls_context":{},
               "filters": [
                         {
                   "type": "proxy",
                         "config": {
                                "downstream_protocol": "Http1",
                                "upstream_protocol": "Http1",
                           "router_config_name":"client_router"
                         }
               },
                         {
                           "type":"connection_manager",
                           "config":{
                                 "router_config_name":"client_router",
                                 "virtual_hosts":[{
                                   "name":"clientHost",
                                   "domains": ["*"],
                                   "routers": [
                                         {
                                           "match":{"prefix":"/"},
                                           "route":{"cluster_name":"clientCluster"}
                                         }
                                   ]
                                 }]
                           }
                   }
                   ]
            }]
          }
       ]
     }
  ],
  "cluster_manager":{     
     "clusters":[
        {
          "Name":"serverCluster",
          "type": "SIMPLE",
          "lb_type": "LB_RANDOM",
          "max_request_per_conn": 1024,
          "conn_buffer_limit_bytes":32768,
          "hosts":[
             {"address":"11.158.132.246:875"}
          ],

    "circuit_breakers":[
        {
            "max_connections":2
        }
    ]
        },
        {
          "Name": "clientCluster",
          "type": "SIMPLE",
          "lb_type": "LB_RANDOM",
          "max_request_per_conn": 1024,
          "conn_buffer_limit_bytes":32768,
          "hosts":[
             {"address":"11.158.132.246:888"}
          ]
        }
     ]
  },
  "admin": {
    "address": {
      "socket_address": {
        "address": "0.0.0.0",
        "port_value": 34901
      }
    }
  },
    "pprof": {
            "debug": true,
                "port_value": 34902
                      }
}

